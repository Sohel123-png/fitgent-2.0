<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitGen 2.0 - Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='apple-design.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="{{ url_for('static', filename='app.js') }}" defer></script>
    <script src="{{ url_for('static', filename='theme-switcher.js') }}" defer></script>
    <script src="{{ url_for('static', filename='anime-characters.js') }}" defer></script>
    <style>
        /* Dashboard specific styles - Apple-inspired with anime elements */
        body {
            background-color: var(--apple-background);
            color: var(--apple-primary-text);
            transition: background-color 0.3s ease, color 0.3s ease;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://i.imgur.com/JYd6Gj3.png');
            background-size: cover;
            background-position: center;
            opacity: 0.03;
            z-index: -1;
            transition: opacity 0.3s ease;
        }

        body.dark-mode::before {
            opacity: 0.05;
        }

        .dashboard-container {
            max-width: 1200px;
            background-color: var(--apple-card-background);
            padding: 30px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            margin: 30px auto;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .anime-character-corner {
            position: absolute;
            top: -60px;
            right: -60px;
            width: 200px;
            height: 200px;
            opacity: 0.7;
            pointer-events: none;
            z-index: 1;
            transition: all 0.3s ease;
        }

        .dashboard-container:hover .anime-character-corner {
            transform: translateY(-10px) rotate(-5deg);
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--apple-separator);
            position: relative;
        }

        .dashboard-title {
            display: flex;
            align-items: center;
            gap: 15px;
            animation: slideIn 0.5s ease-out forwards;
        }

        .dashboard-title h1 {
            margin: 0;
            padding: 0;
            font-family: var(--font-display);
            font-weight: 700;
            color: var(--apple-primary-text);
            transition: color 0.3s ease;
        }

        .dashboard-title h1::after {
            display: none;
        }

        .dashboard-icon {
            font-size: 30px;
            color: var(--apple-blue);
            transition: color 0.3s ease, transform 0.3s ease;
        }

        .dashboard-icon:hover {
            transform: scale(1.1) rotate(10deg);
        }

        .user-welcome {
            font-size: 16px;
            color: var(--apple-secondary-text);
            opacity: 0.9;
            transition: color 0.3s ease;
            animation: fadeIn 0.5s ease-out forwards;
            animation-delay: 0.2s;
            opacity: 0;
        }

        @keyframes slideIn {
            from { transform: translateX(-30px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dashboard-actions {
            display: flex;
            gap: 12px;
            animation: fadeIn 0.5s ease-out forwards;
            animation-delay: 0.3s;
            opacity: 0;
        }

        .action-btn {
            padding: 10px 16px;
            border-radius: var(--radius-pill);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        .action-btn:hover::before {
            transform: translateY(0);
        }

        .action-btn:active {
            transform: translateY(2px);
        }

        .primary-btn {
            background: linear-gradient(45deg, var(--apple-blue), var(--apple-teal));
            color: white;
            border: none;
        }

        .primary-btn.ai-assistant {
            background: linear-gradient(45deg, var(--apple-purple), var(--apple-indigo));
        }

        .primary-btn.notifications {
            background: linear-gradient(45deg, var(--apple-orange), var(--apple-pink));
        }

        .primary-btn.google-fit {
            background: linear-gradient(45deg, var(--apple-red), var(--apple-orange));
        }

        .secondary-btn {
            background: linear-gradient(45deg, var(--apple-teal), var(--apple-blue));
            color: white;
            border: none;
        }

        .logout-btn {
            background: linear-gradient(45deg, var(--apple-red), var(--apple-pink));
            color: white;
            border: none;
        }

        /* Dashboard layout - Apple-inspired */
        .dashboard-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
            position: relative;
        }

        /* Sidebar */
        .dashboard-sidebar {
            background-color: var(--apple-card-background);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-md);
            height: fit-content;
            transition: background-color 0.3s ease, box-shadow 0.3s ease, transform 0.3s ease;
            animation: fadeIn 0.5s ease-out forwards;
            animation-delay: 0.4s;
            opacity: 0;
            position: relative;
            overflow: hidden;
        }

        .dashboard-sidebar:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .dashboard-sidebar::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(to right, var(--apple-blue), var(--apple-purple));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .dashboard-sidebar:hover::after {
            opacity: 1;
        }

        .profile-section {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--apple-separator);
            position: relative;
        }

        .profile-anime {
            position: absolute;
            top: -15px;
            right: -15px;
            width: 60px;
            height: 60px;
            opacity: 0.7;
            transform: rotate(10deg);
            transition: all 0.3s ease;
            z-index: 1;
        }

        .profile-section:hover .profile-anime {
            transform: rotate(0deg) translateY(-5px);
            opacity: 0.9;
        }

        .profile-picture {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background-color: var(--apple-blue);
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            color: white;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 122, 255, 0.3);
            border: 3px solid white;
            transition: all 0.3s ease;
            position: relative;
        }

        .profile-picture::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.2), transparent);
            pointer-events: none;
        }

        .profile-picture:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 122, 255, 0.4);
        }

        .profile-picture img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-name {
            font-size: 20px;
            font-weight: 700;
            color: var(--apple-primary-text);
            margin-bottom: 5px;
            transition: color 0.3s ease;
        }

        .profile-email {
            font-size: 14px;
            color: var(--apple-secondary-text);
            margin-bottom: 15px;
            transition: color 0.3s ease;
        }

        .profile-level {
            display: inline-block;
            padding: 6px 16px;
            background-color: rgba(0, 122, 255, 0.1);
            color: var(--apple-blue);
            border-radius: var(--radius-pill);
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .profile-level:hover {
            background-color: rgba(0, 122, 255, 0.2);
            transform: translateY(-2px);
        }

        .profile-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark-color);
        }

        .stat-label {
            font-size: 12px;
            color: var(--dark-color);
            opacity: 0.7;
            text-transform: uppercase;
        }

        .sidebar-menu {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        .menu-item {
            margin-bottom: 8px;
            opacity: 0;
            animation: fadeIn 0.5s ease-out forwards;
        }

        .menu-item:nth-child(1) { animation-delay: 0.5s; }
        .menu-item:nth-child(2) { animation-delay: 0.55s; }
        .menu-item:nth-child(3) { animation-delay: 0.6s; }
        .menu-item:nth-child(4) { animation-delay: 0.65s; }
        .menu-item:nth-child(5) { animation-delay: 0.7s; }
        .menu-item:nth-child(6) { animation-delay: 0.75s; }
        .menu-item:nth-child(7) { animation-delay: 0.8s; }
        .menu-item:nth-child(8) { animation-delay: 0.85s; }
        .menu-item:nth-child(9) { animation-delay: 0.9s; }
        .menu-item:nth-child(10) { animation-delay: 0.95s; }
        .menu-item:nth-child(11) { animation-delay: 1s; }

        .menu-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: var(--radius-md);
            color: var(--apple-primary-text);
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .menu-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, var(--apple-blue), var(--apple-purple));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .menu-link:hover, .menu-link.active {
            background-color: rgba(0, 122, 255, 0.1);
            color: var(--apple-blue);
            transform: translateX(4px);
        }

        .menu-link:hover::before, .menu-link.active::before {
            opacity: 1;
        }

        .menu-icon {
            font-size: 18px;
            width: 24px;
            text-align: center;
            color: var(--apple-secondary-text);
            transition: color 0.3s ease, transform 0.3s ease;
        }

        .menu-link:hover .menu-icon, .menu-link.active .menu-icon {
            color: var(--apple-blue);
            transform: scale(1.1);
        }

        /* Main content - Apple-inspired */
        .dashboard-main {
            display: grid;
            grid-template-rows: auto 1fr;
            gap: 30px;
            animation: fadeIn 0.5s ease-out forwards;
            animation-delay: 0.3s;
            opacity: 0;
        }

        .content-section {
            background-color: var(--apple-card-background);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-md);
            transition: background-color 0.3s ease, box-shadow 0.3s ease, transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .content-section:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .content-section::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle at top right, rgba(0, 122, 255, 0.05), transparent 70%);
            pointer-events: none;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--apple-separator);
            position: relative;
        }

        .section-anime {
            position: absolute;
            top: -15px;
            right: -15px;
            width: 50px;
            height: 50px;
            opacity: 0;
            transform: rotate(10deg);
            transition: all 0.3s ease;
            z-index: 1;
        }

        .content-section:hover .section-anime {
            opacity: 0.7;
            transform: rotate(0deg);
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--apple-primary-text);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: color 0.3s ease;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(to right, var(--apple-blue), var(--apple-purple));
            transition: width 0.3s ease;
        }

        .content-section:hover .section-title::after {
            width: 100%;
        }

        .section-icon {
            color: var(--apple-blue);
            transition: color 0.3s ease, transform 0.3s ease;
        }

        .content-section:hover .section-icon {
            transform: scale(1.1) rotate(5deg);
        }

        /* Health stats section - Apple-inspired */
        .health-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .health-card {
            background: var(--apple-card-background);
            border-radius: var(--radius-lg);
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            opacity: 0;
            animation: fadeIn 0.5s ease-out forwards;
        }

        .health-card:nth-child(1) { animation-delay: 0.4s; }
        .health-card:nth-child(2) { animation-delay: 0.5s; }
        .health-card:nth-child(3) { animation-delay: 0.6s; }
        .health-card:nth-child(4) { animation-delay: 0.7s; }
        .health-card:nth-child(5) { animation-delay: 0.8s; }

        .health-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(to bottom, var(--apple-blue), var(--apple-teal));
            opacity: 0.7;
            transition: width 0.3s ease;
        }

        .health-card::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 0;
            background: linear-gradient(to right, var(--apple-blue-dark), transparent);
            opacity: 0.05;
            transition: height 0.3s ease;
        }

        .health-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: var(--shadow-md);
        }

        .health-card:hover::before {
            width: 7px;
        }

        .health-card:hover::after {
            height: 100%;
        }

        .health-icon {
            font-size: 30px;
            color: var(--apple-blue);
            margin-bottom: 15px;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .health-card:hover .health-icon {
            transform: scale(1.1) rotate(5deg);
            color: var(--apple-indigo);
        }

        .health-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--apple-primary-text);
            margin: 5px 0;
            transition: color 0.3s ease;
            position: relative;
            display: inline-block;
        }

        .health-value::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background: linear-gradient(to right, var(--apple-blue), var(--apple-purple));
            transition: width 0.3s ease;
        }

        .health-card:hover .health-value::after {
            width: 80%;
        }

        .health-label {
            font-size: 14px;
            color: var(--apple-secondary-text);
            margin-bottom: 10px;
            transition: color 0.3s ease;
        }

        .health-trend {
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            padding: 5px 10px;
            border-radius: var(--radius-pill);
            background-color: rgba(0, 0, 0, 0.03);
            transition: all 0.3s ease;
            margin: 0 auto;
            width: fit-content;
        }

        .health-card:hover .health-trend {
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .trend-up {
            color: var(--apple-green);
        }

        .trend-down {
            color: var(--apple-red);
        }

        .trend-neutral {
            color: var(--apple-orange);
        }

        /* Diet plan section - Apple-inspired */
        .diet-plans {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .meal-card {
            background-color: var(--apple-card-background);
            border-radius: var(--radius-lg);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            opacity: 0;
            animation: fadeIn 0.5s ease-out forwards;
        }

        .meal-card:nth-child(1) { animation-delay: 0.6s; }
        .meal-card:nth-child(2) { animation-delay: 0.7s; }
        .meal-card:nth-child(3) { animation-delay: 0.8s; }

        .meal-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle at top right, rgba(0, 122, 255, 0.05), transparent 70%);
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .meal-card:hover {
            transform: translateY(-5px) scale(1.01);
            box-shadow: var(--shadow-md);
        }

        .meal-card:hover::before {
            opacity: 1;
        }

        .meal-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--apple-separator);
            position: relative;
        }

        .meal-anime {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 40px;
            height: 40px;
            opacity: 0;
            transform: rotate(10deg);
            transition: all 0.3s ease;
            z-index: 1;
        }

        .meal-card:hover .meal-anime {
            opacity: 0.7;
            transform: rotate(0deg);
        }

        .meal-icon {
            font-size: 24px;
            color: var(--apple-blue);
            transition: all 0.3s ease;
        }

        .meal-card:hover .meal-icon {
            transform: scale(1.1) rotate(5deg);
            color: var(--apple-indigo);
        }

        .meal-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--apple-primary-text);
            margin: 0;
            transition: color 0.3s ease;
        }

        .meal-time {
            margin-left: auto;
            font-size: 14px;
            color: var(--apple-secondary-text);
            transition: color 0.3s ease;
            padding: 3px 10px;
            border-radius: var(--radius-pill);
            background-color: rgba(0, 122, 255, 0.1);
        }

        .meal-items {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        .meal-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .meal-item:last-child {
            border-bottom: none;
        }

        .food-icon {
            font-size: 16px;
            color: var(--accent-color);
        }

        .food-name {
            flex: 1;
            font-size: 14px;
            color: var(--dark-color);
        }

        .food-quantity {
            font-size: 14px;
            color: #666;
        }

        .food-calories {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .meal-nutrition {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .nutrition-item {
            text-align: center;
        }

        .nutrition-value {
            font-size: 16px;
            font-weight: 700;
            color: var(--dark-color);
        }

        .nutrition-label {
            font-size: 12px;
            color: #666;
        }

        /* Responsive adjustments */
        @media (max-width: 992px) {
            .dashboard-content {
                grid-template-columns: 1fr;
            }

            .dashboard-sidebar {
                order: 2;
            }

            .dashboard-main {
                order: 1;
            }
        }

        @media (max-width: 768px) {
            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .dashboard-actions {
                width: 100%;
                justify-content: space-between;
            }

            .health-stats, .diet-plans {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container dashboard-container">
        <!-- Anime Character in Corner -->
        <img src="{{ url_for('static', filename='images/anime-character-1.svg') }}" alt="Anime Fitness Character" class="anime-character-corner">

        <!-- Dashboard Header -->
        <div class="dashboard-header">
            <div class="dashboard-title">
                <div class="dashboard-icon">
                    <i class="fas fa-dumbbell"></i>
                </div>
                <div>
                    <h1>FitGen 2.0 Dashboard</h1>
                    <p class="user-welcome">Welcome back, <span id="userName">User</span>!</p>
                </div>
            </div>

            <div class="dashboard-actions">
                <a href="{{ url_for('chatbot.chatbot_page') }}" class="action-btn primary-btn ai-assistant">
                    <i class="fas fa-robot"></i> AI Assistant
                </a>
                <a href="{{ url_for('notifications.notifications_page') }}" class="action-btn primary-btn notifications">
                    <i class="fas fa-bell"></i> Notifications
                </a>
                {% if has_google_fit %}
                <button type="button" id="syncGoogleFitBtn" class="action-btn primary-btn google-fit">
                    <i class="fas fa-sync-alt"></i> Sync Google Fit
                </button>
                <a href="{{ url_for('auth.revoke_google_fit') }}" class="action-btn secondary-btn">
                    <i class="fas fa-unlink"></i> Disconnect Google Fit
                </a>
                {% else %}
                <a href="{{ url_for('auth.authorize_google_fit') }}" class="action-btn primary-btn google-fit">
                    <i class="fab fa-google"></i> Connect Google Fit
                </a>
                {% endif %}
                <button type="button" class="action-btn secondary-btn">
                    <i class="fas fa-cog"></i> Settings
                </button>
                <button type="button" id="logoutBtn" class="action-btn logout-btn">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>

        <!-- Dashboard Content -->
        <div class="dashboard-content">
            <!-- Sidebar -->
            <div class="dashboard-sidebar">
                <div class="profile-section">
                    <img src="{{ url_for('static', filename='images/anime-character-2.svg') }}" alt="Anime Character" class="profile-anime">
                    <div class="profile-picture">
                        <i class="fas fa-user"></i>
                    </div>
                    <h3 class="profile-name" id="profileName">John Doe</h3>
                    <p class="profile-email" id="profileEmail">john@example.com</p>
                    <div class="profile-level" id="profileLevel">Fitness Enthusiast</div>

                    <div class="profile-stats">
                        <div class="stat-item">
                            <div class="stat-value">28</div>
                            <div class="stat-label">Workouts</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">14</div>
                            <div class="stat-label">Days Streak</div>
                        </div>
                    </div>
                </div>

                <!-- Reminders Widget -->
                {% include 'reminders_widget.html' %}

                <ul class="sidebar-menu">
                    <li class="menu-item">
                        <a href="#" class="menu-link active">
                            <span class="menu-icon"><i class="fas fa-home"></i></span>
                            Dashboard
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="#" class="menu-link">
                            <span class="menu-icon"><i class="fas fa-user"></i></span>
                            Profile
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="#" class="menu-link">
                            <span class="menu-icon"><i class="fas fa-heartbeat"></i></span>
                            Health Stats
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="{{ url_for('diet.diet_plan_generator_page') }}" class="menu-link">
                            <span class="menu-icon"><i class="fas fa-utensils"></i></span>
                            Diet Plans
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="#" class="menu-link">
                            <span class="menu-icon"><i class="fas fa-dumbbell"></i></span>
                            Workouts
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="#" class="menu-link">
                            <span class="menu-icon"><i class="fas fa-chart-line"></i></span>
                            Progress
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="{{ url_for('reminders.reminders_page') }}" class="menu-link">
                            <span class="menu-icon"><i class="fas fa-bell"></i></span>
                            Reminders
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="{{ url_for('fitness.fitness_dashboard') }}" class="menu-link">
                            <span class="menu-icon"><i class="fas fa-heartbeat"></i></span>
                            Fitness Stats
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="{{ url_for('google_fit_api.google_fit_page') }}" class="menu-link">
                            <span class="menu-icon"><i class="fab fa-google"></i></span>
                            Google Fit
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="{{ url_for('chatbot.chatbot_page') }}" class="menu-link">
                            <span class="menu-icon"><i class="fas fa-robot"></i></span>
                            AI Assistant
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="{{ url_for('auth.modern_dashboard') }}" class="menu-link">
                            <span class="menu-icon"><i class="fas fa-star"></i></span>
                            FitGen 2.0
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="{{ url_for('notifications.notifications_page') }}" class="menu-link">
                            <span class="menu-icon"><i class="fas fa-bell"></i></span>
                            Notifications
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="{{ url_for('gaming_dashboard') }}" class="menu-link">
                            <span class="menu-icon"><i class="fas fa-gamepad"></i></span>
                            Gaming Dashboard
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="#" class="menu-link">
                            <span class="menu-icon"><i class="fas fa-cog"></i></span>
                            Settings
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Main Content -->
            <div class="dashboard-main">
                <!-- Health Stats Section -->
                <div class="content-section">
                    <div class="section-header">
                        <img src="{{ url_for('static', filename='images/anime-character-2.svg') }}" alt="Anime Character" class="section-anime">
                        <h2 class="section-title">
                            <i class="fas fa-heartbeat section-icon"></i>
                            Health Statistics
                        </h2>
                        <button type="button" class="action-btn primary-btn">
                            <i class="fas fa-plus"></i> Add Measurement
                        </button>
                    </div>

                    <div class="health-stats">
                        <div class="health-card">
                            <div class="health-icon">
                                <i class="fas fa-weight"></i>
                            </div>
                            {% if fitness_data and fitness_data.latest_weight %}
                            <div class="health-value">{{ fitness_data.latest_weight }} kg</div>
                            <div class="health-label">Weight</div>
                            {% if fitness_data.weight_change %}
                                {% if fitness_data.weight_change < 0 %}
                                <div class="health-trend trend-down">
                                    <i class="fas fa-arrow-down"></i> {{ fitness_data.weight_change|abs }} kg this month
                                </div>
                                {% elif fitness_data.weight_change > 0 %}
                                <div class="health-trend trend-up">
                                    <i class="fas fa-arrow-up"></i> {{ fitness_data.weight_change }} kg this month
                                </div>
                                {% else %}
                                <div class="health-trend trend-neutral">
                                    <i class="fas fa-equals"></i> No change this month
                                </div>
                                {% endif %}
                            {% else %}
                                <div class="health-trend trend-neutral">
                                    <i class="fas fa-equals"></i> No previous data
                                </div>
                            {% endif %}
                            {% else %}
                            <div class="health-value">75.5 kg</div>
                            <div class="health-label">Weight</div>
                            <div class="health-trend trend-down">
                                <i class="fas fa-arrow-down"></i> 1.2 kg this month
                            </div>
                            {% endif %}
                        </div>

                        <div class="health-card">
                            <div class="health-icon">
                                <i class="fas fa-fire"></i>
                            </div>
                            {% if fitness_data and fitness_data.today_calories %}
                            <div class="health-value">{{ fitness_data.today_calories }}</div>
                            <div class="health-label">Daily Calories Burned</div>
                            <div class="health-trend trend-neutral">
                                <i class="fas fa-equals"></i> From Google Fit
                            </div>
                            {% else %}
                            <div class="health-value">2,450</div>
                            <div class="health-label">Daily Calories</div>
                            <div class="health-trend trend-neutral">
                                <i class="fas fa-equals"></i> Maintaining
                            </div>
                            {% endif %}
                        </div>

                        <div class="health-card">
                            <div class="health-icon">
                                <i class="fas fa-running"></i>
                            </div>
                            {% if fitness_data and fitness_data.today_steps %}
                            <div class="health-value">{{ fitness_data.today_steps }}</div>
                            <div class="health-label">Steps Today</div>
                            {% if fitness_data.step_change_pct %}
                                {% if fitness_data.step_change_pct > 0 %}
                                <div class="health-trend trend-up">
                                    <i class="fas fa-arrow-up"></i> {{ fitness_data.step_change_pct }}% from yesterday
                                </div>
                                {% elif fitness_data.step_change_pct < 0 %}
                                <div class="health-trend trend-down">
                                    <i class="fas fa-arrow-down"></i> {{ fitness_data.step_change_pct|abs }}% from yesterday
                                </div>
                                {% else %}
                                <div class="health-trend trend-neutral">
                                    <i class="fas fa-equals"></i> Same as yesterday
                                </div>
                                {% endif %}
                            {% else %}
                                <div class="health-trend trend-neutral">
                                    <i class="fas fa-equals"></i> From Google Fit
                                </div>
                            {% endif %}
                            {% else %}
                            <div class="health-value">8,547</div>
                            <div class="health-label">Steps Today</div>
                            <div class="health-trend trend-up">
                                <i class="fas fa-arrow-up"></i> 12% from yesterday
                            </div>
                            {% endif %}
                        </div>

                        <div class="health-card">
                            <div class="health-icon">
                                <i class="fas fa-heart"></i>
                            </div>
                            {% if fitness_data and fitness_data.avg_resting_heart_rate %}
                            <div class="health-value">{{ fitness_data.avg_resting_heart_rate }} bpm</div>
                            <div class="health-label">Resting Heart Rate</div>
                            <div class="health-trend trend-neutral">
                                <i class="fas fa-equals"></i> From Google Fit
                            </div>
                            {% else %}
                            <div class="health-value">72 bpm</div>
                            <div class="health-label">Resting Heart Rate</div>
                            <div class="health-trend trend-down">
                                <i class="fas fa-arrow-down"></i> 3 bpm this month
                            </div>
                            {% endif %}
                        </div>

                        <div class="health-card">
                            <div class="health-icon">
                                <i class="fas fa-bed"></i>
                            </div>
                            {% if fitness_data and fitness_data.last_night_sleep %}
                            <div class="health-value">{{ fitness_data.last_night_sleep }} hrs</div>
                            <div class="health-label">Last Night's Sleep</div>
                            <div class="health-trend trend-neutral">
                                <i class="fas fa-equals"></i> From Google Fit
                            </div>
                            {% else %}
                            <div class="health-value">7.5 hrs</div>
                            <div class="health-label">Sleep Duration</div>
                            <div class="health-trend trend-neutral">
                                <i class="fas fa-equals"></i> No data available
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Diet Plan Section -->
                <div class="content-section">
                    <div class="section-header">
                        <img src="{{ url_for('static', filename='images/anime-character-1.svg') }}" alt="Anime Character" class="section-anime">
                        <h2 class="section-title">
                            <i class="fas fa-utensils section-icon"></i>
                            Today's Diet Plan
                        </h2>
                        <a href="{{ url_for('diet.diet_plan_generator_page') }}" class="action-btn primary-btn">
                            <i class="fas fa-edit"></i> Customize Plan
                        </a>
                    </div>

                    <div class="diet-plans">
                        <div class="meal-card">
                            <div class="meal-header">
                                <img src="{{ url_for('static', filename='images/anime-character-2.svg') }}" alt="Anime Character" class="meal-anime">
                                <div class="meal-icon">
                                    <i class="fas fa-coffee"></i>
                                </div>
                                <h3 class="meal-title">Breakfast</h3>
                                <div class="meal-time">7:00 AM</div>
                            </div>

                            <ul class="meal-items">
                                <li class="meal-item">
                                    <span class="food-icon"><i class="fas fa-egg"></i></span>
                                    <span class="food-name">Scrambled Eggs</span>
                                    <span class="food-quantity">2 eggs</span>
                                    <span class="food-calories">180 kcal</span>
                                </li>
                                <li class="meal-item">
                                    <span class="food-icon"><i class="fas fa-bread-slice"></i></span>
                                    <span class="food-name">Whole Grain Toast</span>
                                    <span class="food-quantity">2 slices</span>
                                    <span class="food-calories">160 kcal</span>
                                </li>
                                <li class="meal-item">
                                    <span class="food-icon"><i class="fas fa-apple-alt"></i></span>
                                    <span class="food-name">Apple</span>
                                    <span class="food-quantity">1 medium</span>
                                    <span class="food-calories">95 kcal</span>
                                </li>
                            </ul>

                            <div class="meal-nutrition">
                                <div class="nutrition-item">
                                    <div class="nutrition-value">435</div>
                                    <div class="nutrition-label">Calories</div>
                                </div>
                                <div class="nutrition-item">
                                    <div class="nutrition-value">25g</div>
                                    <div class="nutrition-label">Protein</div>
                                </div>
                                <div class="nutrition-item">
                                    <div class="nutrition-value">45g</div>
                                    <div class="nutrition-label">Carbs</div>
                                </div>
                                <div class="nutrition-item">
                                    <div class="nutrition-value">15g</div>
                                    <div class="nutrition-label">Fat</div>
                                </div>
                            </div>
                        </div>

                        <div class="meal-card">
                            <div class="meal-header">
                                <img src="{{ url_for('static', filename='images/anime-character-1.svg') }}" alt="Anime Character" class="meal-anime">
                                <div class="meal-icon">
                                    <i class="fas fa-drumstick-bite"></i>
                                </div>
                                <h3 class="meal-title">Lunch</h3>
                                <div class="meal-time">12:30 PM</div>
                            </div>

                            <ul class="meal-items">
                                <li class="meal-item">
                                    <span class="food-icon"><i class="fas fa-drumstick-bite"></i></span>
                                    <span class="food-name">Grilled Chicken Breast</span>
                                    <span class="food-quantity">150g</span>
                                    <span class="food-calories">250 kcal</span>
                                </li>
                                <li class="meal-item">
                                    <span class="food-icon"><i class="fas fa-seedling"></i></span>
                                    <span class="food-name">Mixed Salad</span>
                                    <span class="food-quantity">100g</span>
                                    <span class="food-calories">35 kcal</span>
                                </li>
                                <li class="meal-item">
                                    <span class="food-icon"><i class="fas fa-carrot"></i></span>
                                    <span class="food-name">Sweet Potato</span>
                                    <span class="food-quantity">1 medium</span>
                                    <span class="food-calories">115 kcal</span>
                                </li>
                            </ul>

                            <div class="meal-nutrition">
                                <div class="nutrition-item">
                                    <div class="nutrition-value">400</div>
                                    <div class="nutrition-label">Calories</div>
                                </div>
                                <div class="nutrition-item">
                                    <div class="nutrition-value">40g</div>
                                    <div class="nutrition-label">Protein</div>
                                </div>
                                <div class="nutrition-item">
                                    <div class="nutrition-value">30g</div>
                                    <div class="nutrition-label">Carbs</div>
                                </div>
                                <div class="nutrition-item">
                                    <div class="nutrition-value">8g</div>
                                    <div class="nutrition-label">Fat</div>
                                </div>
                            </div>
                        </div>

                        <div class="meal-card">
                            <div class="meal-header">
                                <img src="{{ url_for('static', filename='images/anime-character-2.svg') }}" alt="Anime Character" class="meal-anime">
                                <div class="meal-icon">
                                    <i class="fas fa-fish"></i>
                                </div>
                                <h3 class="meal-title">Dinner</h3>
                                <div class="meal-time">7:00 PM</div>
                            </div>

                            <ul class="meal-items">
                                <li class="meal-item">
                                    <span class="food-icon"><i class="fas fa-fish"></i></span>
                                    <span class="food-name">Grilled Salmon</span>
                                    <span class="food-quantity">150g</span>
                                    <span class="food-calories">280 kcal</span>
                                </li>
                                <li class="meal-item">
                                    <span class="food-icon"><i class="fas fa-leaf"></i></span>
                                    <span class="food-name">Steamed Broccoli</span>
                                    <span class="food-quantity">100g</span>
                                    <span class="food-calories">55 kcal</span>
                                </li>
                                <li class="meal-item">
                                    <span class="food-icon"><i class="fas fa-seedling"></i></span>
                                    <span class="food-name">Quinoa</span>
                                    <span class="food-quantity">100g cooked</span>
                                    <span class="food-calories">120 kcal</span>
                                </li>
                            </ul>

                            <div class="meal-nutrition">
                                <div class="nutrition-item">
                                    <div class="nutrition-value">455</div>
                                    <div class="nutrition-label">Calories</div>
                                </div>
                                <div class="nutrition-item">
                                    <div class="nutrition-value">42g</div>
                                    <div class="nutrition-label">Protein</div>
                                </div>
                                <div class="nutrition-item">
                                    <div class="nutrition-value">25g</div>
                                    <div class="nutrition-label">Carbs</div>
                                </div>
                                <div class="nutrition-item">
                                    <div class="nutrition-value">18g</div>
                                    <div class="nutrition-label">Fat</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Check if user is logged in
        const token = localStorage.getItem('token');
        if (!token) {
            window.location.href = '/login';
        }

        // Initialize anime characters
        document.addEventListener('DOMContentLoaded', function() {
            // Add random animations to anime characters
            const animeElements = document.querySelectorAll('.anime-character-corner, .profile-anime, .section-anime, .meal-anime');
            const animations = ['float', 'pulse', 'bounce'];

            animeElements.forEach(element => {
                const randomAnimation = animations[Math.floor(Math.random() * animations.length)];
                element.classList.add(`anime-${randomAnimation}`);
            });

            // Add random quotes on hover for anime characters
            const quotes = [
                "Let's crush today's workout!",
                "Stay hydrated and motivated!",
                "You're doing amazing! Keep it up!",
                "Remember, progress is progress, no matter how small!",
                "Balanced nutrition is the foundation of fitness!",
                "One more rep! You can do it!",
                "Form is key - quality over quantity!",
                "Push your limits, but listen to your body!"
            ];

            animeElements.forEach(element => {
                element.addEventListener('mouseenter', function() {
                    // Create quote bubble if it doesn't exist
                    if (!this.nextElementSibling || !this.nextElementSibling.classList.contains('quote-bubble')) {
                        const bubble = document.createElement('div');
                        bubble.className = 'quote-bubble';
                        bubble.textContent = quotes[Math.floor(Math.random() * quotes.length)];
                        this.parentNode.insertBefore(bubble, this.nextSibling);

                        // Position the bubble
                        const rect = this.getBoundingClientRect();
                        bubble.style.position = 'absolute';
                        bubble.style.top = `${this.offsetTop}px`;
                        bubble.style.left = `${this.offsetLeft + this.offsetWidth}px`;
                        bubble.style.zIndex = '1000';

                        // Add styles for the bubble
                        bubble.style.background = 'white';
                        bubble.style.padding = '8px 12px';
                        bubble.style.borderRadius = '10px';
                        bubble.style.boxShadow = '0 2px 10px rgba(0,0,0,0.1)';
                        bubble.style.maxWidth = '200px';
                        bubble.style.fontSize = '14px';
                        bubble.style.animation = 'fadeIn 0.3s forwards';
                    }
                });

                element.addEventListener('mouseleave', function() {
                    // Remove quote bubble
                    const bubble = this.nextElementSibling;
                    if (bubble && bubble.classList.contains('quote-bubble')) {
                        bubble.remove();
                    }
                });
            });
        });

        // Function to decode JWT token
        function parseJwt(token) {
            try {
                const base64Url = token.split('.')[1];
                const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
                const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                }).join(''));
                return JSON.parse(jsonPayload);
            } catch (e) {
                return null;
            }
        }

        // Get user info from token
        const userData = parseJwt(token);
        if (userData) {
            // Update user information
            document.getElementById('userName').textContent = userData.sub.email.split('@')[0] || 'User';
            document.getElementById('profileName').textContent = userData.sub.email.split('@')[0] || 'User';
            document.getElementById('profileEmail').textContent = userData.sub.email || 'user@example.com';

            // Update user level
            const userLevel = userData.sub.role === 'Admin' ? 'Fitness Trainer' : 'Fitness Enthusiast';
            document.getElementById('profileLevel').textContent = userLevel;
        }

        // Logout functionality
        document.getElementById('logoutBtn').addEventListener('click', function() {
            localStorage.removeItem('token');
            window.location.href = '/login';
        });

        // Google Fit sync functionality
        const syncGoogleFitBtn = document.getElementById('syncGoogleFitBtn');
        if (syncGoogleFitBtn) {
            syncGoogleFitBtn.addEventListener('click', async function() {
                try {
                    // Show loading state
                    syncGoogleFitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Syncing...';
                    syncGoogleFitBtn.disabled = true;

                    // Call the sync endpoint
                    const response = await fetch('/sync-google-fit');
                    const data = await response.json();

                    if (data.success) {
                        // Reload the page to show updated data
                        window.location.reload();
                    } else {
                        alert('Error syncing with Google Fit: ' + (data.error || 'Unknown error'));

                        // Reset button
                        syncGoogleFitBtn.innerHTML = '<i class="fas fa-sync-alt"></i> Sync Google Fit';
                        syncGoogleFitBtn.disabled = false;
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('An error occurred while syncing with Google Fit. Please try again.');

                    // Reset button
                    syncGoogleFitBtn.innerHTML = '<i class="fas fa-sync-alt"></i> Sync Google Fit';
                    syncGoogleFitBtn.disabled = false;
                }
            });
        }

        // Show Google Fit connection status
        {% if has_google_fit %}
        console.log('Connected to Google Fit');
        {% else %}
        console.log('Not connected to Google Fit');
        {% endif %}

        // Show fitness data if available
        {% if fitness_data %}
        console.log('Fitness data available:', {{ fitness_data|tojson }});
        {% else %}
        console.log('No fitness data available');
        {% endif %}
    </script>
</body>
</html>
